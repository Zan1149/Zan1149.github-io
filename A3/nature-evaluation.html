<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Experience the NRES</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root{
  --hover-scale: 1.18;
  --active-scale: 1.35;

  --z9-w: 145%;      --z9-top: 50%;      --z9-left: 49.5%;
  --mountain-w: 145%;--mountain-top: 50%;--mountain-left: 50%;
  --sea-w: 145%;     --sea-top: 50%;     --sea-left: 50%;

  --z9-hit-w: 35%;   --z9-hit-h: 30%;
  --mountain-hit-w: 20%; --mountain-hit-h: 12%;
  --sea-hit-w: 30%;      --sea-hit-h: 20%;

  --z9-hit-top: 50%;       --z9-hit-left: 55%;
  --mountain-hit-top: 22%; --mountain-hit-left: 78%;
  --sea-hit-top: 30%;      --sea-hit-left: 22.5%;

  --gap: 16px; 
  --neon: #69f0ae;
  --neon-soft: rgba(105,240,174,.55);
}

html,body{height:100%;margin:0}
body{
  background: linear-gradient(180deg, #39b456 0%, #7ecfea 50%, #e0f7f0 100%);
  display:flex; flex-direction:column; align-items:center;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial
}

.page { width:100%; display:flex; flex-direction:column; align-items:center; gap:12px; padding:18px 12px 0; }
.header { max-width: 860px; text-align:center; color:#0b1220; }
.header p{ margin:0; font-size: clamp(14px, 1.8vw, 16px); line-height:1.6; color: rgba(11,18,32,.86); }

.stage{ position: relative; display: inline-block; }

.globe{
  position:relative; width:80vmin; aspect-ratio:1/1;
  border-radius:20px; overflow:hidden; background:transparent;
}
.earth{width:100%; height:100%; object-fit:cover; display:block;}

.block{
  position:absolute; z-index:1;
  width:var(--w); top:var(--top); left:var(--left);
  transform:translate(-50%, -50%);
  pointer-events:none;
  will-change:transform,filter;
  transition:transform .25s ease, filter .25s ease, opacity .25s ease;
  opacity:.98; filter: drop-shadow(0 8px 12px rgba(0,0,0,.35));
}
.block.hovering{
  transform:translate(-50%,-50%) scale(var(--hover-scale));
  filter: drop-shadow(0 0 18px var(--neon-soft)) drop-shadow(0 0 32px rgba(105,240,174,.25));
  z-index: 10;
}
.block::after{
  content:""; position:absolute; inset:-4% -4% -4% -4%;
  border-radius:12px; left:50%; top:50%; transform:translate(-50%,-50%);
  opacity:0; pointer-events:none;
}
.block.hovering::after,.stage.open .block.active::after{ animation:pulse 1.6s ease-out infinite; }
@keyframes pulse{
  0%{ box-shadow:0 0 0 0 var(--neon-soft); opacity:.9 }
  70%{ box-shadow:0 0 0 20px rgba(105,240,174,0); opacity:0 }
  100%{ box-shadow:0 0 0 0 rgba(105,240,174,0); opacity:0 }
}
.stage.open .block.active{
  transform:translate(-50%,-50%) scale(var(--active-scale));
  filter: drop-shadow(0 0 22px var(--neon-soft)) drop-shadow(0 0 36px rgba(105,240,174,.3));
}

.hot{
  position:absolute; z-index:2;
  width:var(--hit-w); height:var(--hit-h);
  top:var(--top); left:var(--left);
  transform:translate(-50%, -50%);
  cursor:pointer; background:transparent; border-radius:12px;
}
.debug .hot{ outline:1px dashed rgba(0,0,0,.35); background:rgba(255,255,255,.10); }

.label{
  position:absolute; z-index:3;
  left:var(--left); top:var(--top);
  transform:translate(calc(-50% + var(--label-ox, 0px)), calc(-50% + var(--label-oy, 0px)));
  white-space:nowrap;
  font-size:13px; line-height:1;
  color:#fff; padding:6px 10px; border-radius:999px;
  background: rgba(0,0,0,.55);
  border:1px solid rgba(255,255,255,.25);
  box-shadow:0 2px 10px rgba(0,0,0,.25);
  pointer-events:none; user-select:none;
}

.holo{
  position:absolute; z-index:4;
  width:min(44vmin, 420px); max-width:90%;
  padding:10px; border-radius:16px;
  border:1px solid rgba(255,255,255,.25);
  background: linear-gradient(to bottom right, rgba(255,255,255,.12), rgba(255,255,255,.07));
  backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 12px 40px rgba(0,0,0,.35), 0 0 24px rgba(105,240,174,.22) inset;
  opacity:0; pointer-events:none; 
  left:100%; top:var(--top);
  transform: translate(var(--gap),-50%) scale(.96);
  transition: opacity .25s ease, transform .25s ease, left .2s ease, top .2s ease;


}

.stage.open .holo{ opacity:1; pointer-events:auto; }


.holo .holo-body{ display:grid; gap:10px; }


.videoWrap{ position: relative; }
.videoOverlay{
  position:absolute; left:10px; bottom:10px;
  padding:6px 10px; border-radius:10px;
  background: linear-gradient(90deg, rgba(0,0,0,.55), rgba(0,0,0,.25));
  color:#fff; font-size:14px; line-height:1.4; max-width:85%;
  pointer-events:none; user-select:none;
}


.holo .holoContent{ display:none; border-radius:12px; padding:10px; }
.holo .holoContent.scrollable{ display:block; max-height:55vmin; overflow:auto; }


.holo video{ width:100%; height:auto; display:none; border-radius:12px; background:#000; }
.holo.has-video   video{ display:block; }


.holo.left{ left:0;    top:var(--top); transform: translate(calc(-100% - var(--gap)),-50%) scale(1); }
.holo.right{ left:100%; top:var(--top); transform: translate(var(--gap),-50%) scale(1); }
.holo.right-bottom{ left:100%; top:calc(var(--top) + 24%); transform: translate(var(--gap),-50%) scale(1); }
.holo.left-bottom{ left:0; top:calc(var(--top) + 24%); transform: translate(calc(-100% - var(--gap)),-50%) scale(1); }

@media (max-width: 680px){
  .holo{ left:50%!important; top:85%!important; transform:translate(-50%,-50%) scale(1)!important; }
}


.score-toggle{
  position: fixed;
  right: 18px; bottom: 18px;
  z-index: 10;
  background: linear-gradient(135deg, #21c77a, #69f0ae);
  color: #0b1220; font-weight: 700;
  border: none; border-radius: 999px;
  padding: 12px 16px; cursor: pointer;
  box-shadow: 0 10px 25px rgba(0,0,0,.25), 0 0 20px rgba(105,240,174,.45);
}
.score-toggle:active{ transform: translateY(1px); }

.score-dock{
  position: fixed;
  right: 18px; bottom: 76px;
  width: min(92vw, 420px);
  max-height: 78vh;
  overflow: hidden;
  z-index: 9;
  border-radius: 18px;
  border: 1px solid rgba(255,255,255,.25);
  background: linear-gradient(135deg, rgba(255,255,255,.15), rgba(255,255,255,.08));
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 18px 45px rgba(0,0,0,.35), inset 0 0 24px rgba(105,240,174,.18);
  opacity: 0; transform: translateY(12px) scale(.98);
  pointer-events: none;
  transition: opacity .25s ease, transform .25s ease;
}
.score-dock.open{ opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }

.sd-head{
  display: flex; align-items: center; justify-content: space-between;
  padding: 12px 14px; gap:10px;
  border-bottom: 1px solid rgba(255,255,255,.15);
}
.sd-tabs{ display:flex; gap:8px; flex-wrap: wrap; }
.sd-tab{
  background: rgba(0,0,0,.35); color:#fff; border:1px solid rgba(255,255,255,.2);
  padding: 6px 10px; border-radius: 999px; cursor: pointer; font-size: 13px;
}
.sd-tab.active{ background: linear-gradient(135deg, #21c77a, #69f0ae); color:#0b1220; border-color: transparent; }

.sd-body{
  display: grid; gap: 12px; padding: 12px 14px;
  grid-template-columns: 1.2fr .8fr; align-items: start;
}
@media (max-width: 520px){
  .sd-body{ grid-template-columns: 1fr; }
}

.metric{
  display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center;
  margin: 6px 0;
}
.metric label{ font-size: 13px; color:#0b1220; font-weight: 600; }
.value-badge{
  min-width: 40px; text-align: right; font-variant-numeric: tabular-nums;
  color:#0b1220; font-weight:700; background: rgba(255,255,255,.6);
  padding:4px 8px; border-radius: 8px; border:1px solid rgba(0,0,0,.08);
}
input[type="range"]{
  -webkit-appearance: none; appearance: none;
  height: 8px; border-radius: 999px; background: rgba(255,255,255,.4); outline: none;
}
input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance: none; appearance: none;
  width: 18px; height: 18px; border-radius:50%;
  background: linear-gradient(135deg, #21c77a, #69f0ae);
  border: 1px solid rgba(0,0,0,.15);
  box-shadow: 0 2px 10px rgba(0,0,0,.25);
  cursor: pointer;
}

.sd-side{ display:grid; gap:12px; }

.overall{
  display:flex; align-items:center; justify-content:space-between;
  padding:10px 12px; border-radius: 12px;
  background: rgba(255,255,255,.6);
  border: 1px solid rgba(0,0,0,.08);
}
.overall .score{
  font-size: 28px; line-height:1; font-weight: 800;
  color:#0b1220;
}
.overall .tag{
  font-size: 12px; padding:4px 8px; border-radius: 999px; font-weight:700;
  background: #0b1220; color:#69f0ae;
}

.radar{
  background: rgba(255,255,255,.5);
  border:1px solid rgba(0,0,0,.08); border-radius: 12px;
  padding:8px;
  display:flex; align-items:center; justify-content:center; min-height: 160px;
}


.decision{
  display:inline-flex; align-items:center;
  border-radius: 999px; overflow:hidden;
  border:1px solid rgba(0,0,0,.15);
  background: rgba(255,255,255,.65);
  box-shadow: inset 0 0 12px rgba(0,0,0,.05);
  user-select:none;
}
.decision button{
  appearance:none; border:0; padding:10px 14px; font-weight:700; font-size:14px;
  cursor:pointer; background:transparent; color:#0b1220;
}
.decision button + button{ border-left:1px solid rgba(0,0,0,.12); }
.decision button.active{
  background: linear-gradient(135deg, #21c77a, #69f0ae);
  color:#0b1220;
}

.sd-foot{
  display:flex; justify-content: flex-end; align-items:center;
  padding: 10px 14px; gap:10px; border-top:1px solid rgba(255,255,255,.15);
}
.sd-foot .btn{
  border:none; border-radius:10px; padding:8px 12px; cursor:pointer; font-weight:700;
}
.btn-save{ background:#0b1220; color:#69f0ae; }


.back-home{
  position: fixed; left: 18px; bottom: 18px; z-index: 11;
  text-decoration:none; font-weight:800; font-size:14px;
  padding:10px 14px; border-radius:999px; border:1px solid rgba(255,255,255,.25);
  background: linear-gradient(135deg, rgba(255,255,255,.85), rgba(255,255,255,.6));
  color:#0b1220; box-shadow:0 10px 25px rgba(0,0,0,.18);
}
.back-home:active{ transform: translateY(1px); }

.decision-hint {
  position: fixed;
  bottom: 116px;
  left: 50%;
  transform: translateX(-50%);
  background: transparent;
  border: 0;
  padding: 0 16px;
  font-size: clamp(13px, 1.6vw, 16px);
  font-weight: 600;
  color: #0b1220;
  z-index: 12;
}
.decision-hint::before,
.decision-hint::after{
  content:"";
  position: absolute;
  top: 50%;
  width: 40px; height: 1px;
  background: rgba(11,18,32,0.28);
  transform: translateY(-50%);
}
.decision-hint::before{ left: -56px; }
.decision-hint::after{  right: -56px; }
@media (max-width: 520px){
  .decision-hint::before, .decision-hint::after{ width: 28px; }
}
</style>
</head>
<body>

<div class="page">
  <div class="header">
    <p>You can click on areas on the earth to view the holographic experience card and listen to the sounds of nature. Meanwhile, you can click on the Natural Ratings at the lower right corner to try out the rating.</p>
  </div>

  <div class="stage" id="stage">
    <div class="globe" id="globe">
      <img src="image/earth map.png" alt="Earth" class="earth">

      <div class="hot" id="hit-z9"
          style="--hit-w: var(--z9-hit-w); --hit-h: var(--z9-hit-h);
                  --top: var(--z9-hit-top);  --left: var(--z9-hit-left);"
          data-key="z9"
          data-template="#tpl-z9"></div>
      <img src="image/z-9.png" alt="Z-9" class="block" id="z9"
          style="--w: var(--z9-w); --top: var(--z9-top); --left: var(--z9-left);">
      <div class="label"
          style="--top: var(--z9-hit-top); --left: var(--z9-hit-left);">Z-9</div>

      <div class="hot" id="hit-mountain"
          style="--hit-w: var(--mountain-hit-w); --hit-h: var(--mountain-hit-h);
                  --top: var(--mountain-hit-top);  --left: var(--mountain-hit-left);"
          data-key="mountain"
          data-video="video/mountain.mp4"
          data-videotext="Natural Sounds of the Snow Mountain section"></div>
      <img src="image/mountain.png" alt="Mountain" class="block" id="mountain"
          style="--w: var(--mountain-w); --top: var(--mountain-top); --left: var(--mountain-left);">
      <div class="label"
          style="--top: var(--mountain-hit-top); --left: var(--mountain-hit-left);">snow mountain</div>

      <div class="hot" id="hit-sea"
          style="--hit-w: var(--sea-hit-w); --hit-h: var(--sea-hit-h);
                  --top: var(--sea-hit-top);  --left: var(--sea-hit-left);"
          data-key="sea"
          data-video="video/sea.mp4"
          data-videotext="Voice of Nature in the Ocean section"></div>
      <img src="image/sea.png" alt="Sea" class="block" id="sea"
          style="--w: var(--sea-w); --top: var(--sea-top); --left: var(--sea-left);">
      <div class="label"
          style="--top: var(--sea-hit-top); --left: var(--sea-hit-left);">Sea</div>
    </div>

    <div class="holo" id="holo">
      <div class="holo-body">
        <div class="videoWrap">
          <video id="holoVideo" playsinline></video>
          <div class="videoOverlay" id="videoOverlay"></div>
        </div>
        <div class="holoContent" id="holoContent"></div>
      </div>
    </div>
  </div>
</div>

</div>
<div class="decision-hint">If it were you, how would you decide the fate of nature?</div>
</div>


<a class="back-home" href="A3.html#chap1">back homepage</a>

<template id="tpl-z9">
  <div>
    <h3 style="margin:0 0 6px 0">Z-9 The story of the rainforest section</h3>
    <p style="margin:0 0 8px 0; line-height:1.6;">In the remote Z-9 Rainforest Reserve, inspector Zora was tasked with a challenging mission: to investigate the reasons behind the reserve's “low performance” over three consecutive quarters and, based on system evaluations, decide whether to preserve the rainforest's natural state or transform it into a “smart ecological commercial zone".</p>
    <p style="margin:0 0 8px 0;">The rainforest is vast, yet the system has labeled it as having “insufficient net carbon contribution,” “abnormal fluctuations in sound diversity,” “low animal interaction rates,” and “tourist experience value: below standard.” In simpler terms: too quiet, too boring, and not profitable enough.</p>
    <p style="margin:0 0 8px 0;">More importantly, this rainforest has long failed to produce clear “natural expressions.” In theory, after connecting to natural communication devices, every tree and every bird should be able to emit “emotional markers” in synthetic language—sadness, joy, anger, alertness. But Z-9 said nothing.</p>
    <p style="margin:0 0 8px 0;"><strong>“It might just be lifeless,” the system calmly suggested.</p>
  </div>
</template>


<button class="score-toggle" id="scoreToggle">🌿 Natural scoring</button>
<div class="score-dock" id="scoreDock" aria-hidden="true">
  <div class="sd-head">
    <div class="sd-tabs" id="sdTabs">
      <button class="sd-tab active" data-region="z9">Z-9</button>
      <button class="sd-tab" data-region="mountain">Snow mountain</button>
      <button class="sd-tab" data-region="sea">Sea</button>
    </div>
    <div class="tag overall-hint" style="font-size:12px;color:#0b1220;">Drag the slider to rate</div>
  </div>

  <div class="sd-body">
    <div class="sd-form" id="sdForm">
      <div class="metric">
        <label>Air purification rate</label>
        <div class="value-badge" id="v-air">0</div>
        <input type="range" id="air" min="0" max="100" step="1" value="0">
      </div>
      <div class="metric">
        <label>Biological interaction activity level</label>
        <div class="value-badge" id="v-bio">0</div>
        <input type="range" id="bio" min="0" max="100" step="1" value="0">
      </div>
      <div class="metric">
        <label>Tourism experience rating</label>
        <div class="value-badge" id="v-tour">0</div>
        <input type="range" id="tour" min="0" max="100" step="1" value="0">
      </div>
      <div class="metric">
        <label>Business potential assessment</label>
        <div class="value-badge" id="v-biz">0</div>
        <input type="range" id="biz" min="0" max="100" step="1" value="0">
      </div>
    </div>

    <div class="sd-side">
      <div class="overall">
        <div>
          <div style="font-size:12px;color:#0b1220;opacity:.8;">Overall</div>
          <div class="score" id="overallScore">0</div>
        </div>
        <div class="tag" id="overallTag">To be evaluated</div>
      </div>


      <div class="radar">
        <div class="decision" role="tablist" aria-label="Region decision">
          <button type="button" id="keepBtn" role="tab" aria-selected="true">Keep</button>
          <button type="button" id="actBtn"  role="tab" aria-selected="false">Act</button>
        </div>
      </div>
    </div>
  </div>

  <div class="sd-foot">
    <button class="btn btn-save" id="btnSave">Save the score</button>
  </div>
</div>

<script>
  const stage = document.getElementById('stage');
  const holo  = document.getElementById('holo');
  const videoEl  = document.getElementById('holoVideo');
  const contentEl = document.getElementById('holoContent');
  const overlayEl = document.getElementById('videoOverlay');

  const blocks = {
    z9: document.getElementById('z9'),
    mountain: document.getElementById('mountain'),
    sea: document.getElementById('sea'),
  };

  function getContentFromHot(hot){
    const tplSel = hot.dataset.template;
    if (tplSel) {
      const tpl = document.querySelector(tplSel);
      if (tpl) return tpl.innerHTML;
    }
    if (hot.dataset.html) return hot.dataset.html;
    return '';
  }

  document.querySelectorAll('.hot').forEach(hot=>{
    const key = hot.dataset.key;
    const img = blocks[key];

    hot.addEventListener('pointerenter', ()=> img.classList.add('hovering'));
    hot.addEventListener('pointerleave', ()=> img.classList.remove('hovering'));

    hot.addEventListener('click', (e)=>{
      e.stopPropagation();

      Object.values(blocks).forEach(b=>b.classList.remove('active'));
      img.classList.add('active');

      const topVar = getComputedStyle(hot).getPropertyValue('--top').trim();
      holo.style.setProperty('--top', topVar);

      holo.className = 'holo';
      if (key === 'mountain')      holo.classList.add('right');
      else if (key === 'sea')      holo.classList.add('left');
      else                         holo.classList.add('right-bottom');

      videoEl.pause(); videoEl.removeAttribute('loop'); videoEl.removeAttribute('src');
      contentEl.innerHTML = ''; overlayEl.textContent = '';
      contentEl.classList.remove('scrollable'); 

      let showVideo = false, showContent = false;

      const videoSrc = hot.dataset.video;
      if (videoSrc){
        if (videoEl.currentSrc.endsWith(videoSrc) || videoEl.src.endsWith(videoSrc)) {
          try { videoEl.currentTime = 0; } catch(e){}
        } else {
          videoEl.src = videoSrc;
        }
        videoEl.muted = false; videoEl.volume = 1;
        videoEl.play().catch(()=>{});
        showVideo = true;

        if (hot.dataset.videotext){
          overlayEl.textContent = hot.dataset.videotext;
        }
      }

      const html = getContentFromHot(hot);
      if (html){
        contentEl.innerHTML = html;
        showContent = true;

        if (key === 'z9') {
          contentEl.classList.add('scrollable');
        }
      }

      if (showVideo)   holo.classList.add('has-video');
      if (showContent) holo.classList.add('has-content');

      stage.classList.add('open');
    });
  });

  videoEl.addEventListener('ended', ()=>{ try { videoEl.pause(); } catch(e){} });

  holo.addEventListener('click', (e)=> e.stopPropagation());
  document.addEventListener('click', (e)=>{
    const clickedInsideHolo = holo.contains(e.target);
    const clickedHot = e.target.closest('.hot');
    if (!clickedInsideHolo && !clickedHot) closeHolo();
  });
  document.addEventListener('keydown', (e)=>{
    if((e.key||'').toLowerCase() === 'escape') closeHolo();
    if((e.key||'').toLowerCase() === 'h') document.body.classList.toggle('debug');
  });

  function closeHolo(){
    stage.classList.remove('open');
    Object.values(blocks).forEach(b=> b.classList.remove('active','hovering'));
    try { videoEl.pause(); videoEl.removeAttribute('src'); } catch(e){}
    contentEl.innerHTML = ''; overlayEl.textContent = '';
    contentEl.classList.remove('scrollable');
    holo.className = 'holo';
  }

  const scoreToggle = document.getElementById('scoreToggle');
  const scoreDock   = document.getElementById('scoreDock');
  const tabsWrap    = document.getElementById('sdTabs');
  const tabs        = Array.from(tabsWrap.querySelectorAll('.sd-tab'));

  const inputs = {
    air:  document.getElementById('air'),
    bio:  document.getElementById('bio'),
    tour: document.getElementById('tour'),
    biz:  document.getElementById('biz'),
  };
  const badges = {
    air:  document.getElementById('v-air'),
    bio:  document.getElementById('v-bio'),
    tour: document.getElementById('v-tour'),
    biz:  document.getElementById('v-biz'),
  };
  const overallScoreEl = document.getElementById('overallScore');
  const overallTagEl   = document.getElementById('overallTag');
  const btnSave  = document.getElementById('btnSave');

  const keepBtn = document.getElementById('keepBtn');
  const actBtn  = document.getElementById('actBtn');

  const METRICS = ['air','bio','tour','biz'];
  const WEIGHTS = { air:1, bio:1, tour:1, biz:1 };

  const defaultScores = {
    z9:       { air:70, bio:65, tour:60, biz:55, decision:'keep' },
    mountain: { air:82, bio:76, tour:85, biz:58, decision:'keep' },
    sea:      { air:74, bio:72, tour:80, biz:62, decision:'keep' },
  };

  let currentRegion = 'z9';
  let store = loadStore() || structuredClone(defaultScores);
  applyRegion(currentRegion);

  scoreToggle.addEventListener('click', (e)=>{
    e.stopPropagation();
    const open = scoreDock.classList.toggle('open');
    scoreDock.setAttribute('aria-hidden', open ? 'false' : 'true');
  });

  scoreDock.addEventListener('click', (e)=> e.stopPropagation());


  tabsWrap.addEventListener('click', (e)=>{
    const btn = e.target.closest('.sd-tab');
    if (!btn) return;
    tabs.forEach(t=>t.classList.toggle('active', t===btn));
    currentRegion = btn.dataset.region;
    applyRegion(currentRegion);
  });


  Object.entries(inputs).forEach(([key, input])=>{
    input.addEventListener('input', ()=>{
      badges[key].textContent = input.value;
      store[currentRegion][key] = Number(input.value);
      updateOverall();
    });
  });


  keepBtn.addEventListener('click', ()=>{ setDecision('keep'); });
  actBtn.addEventListener('click',  ()=>{ setDecision('act');  });

  function setDecision(val){
    store[currentRegion].decision = val;
    keepBtn.classList.toggle('active', val==='keep');
    actBtn.classList.toggle('active',  val==='act');
    keepBtn.setAttribute('aria-selected', val==='keep' ? 'true' : 'false');
    actBtn.setAttribute('aria-selected',  val==='act'  ? 'true' : 'false');
  }


  btnSave.addEventListener('click', ()=>{
    saveStore();
    btnSave.textContent = 'Saved ✓';
    setTimeout(()=> btnSave.textContent = 'Save Score', 1200);
  });

  function applyRegion(region){
    const data = store[region];
    METRICS.forEach(m=>{
      inputs[m].value = data[m];
      badges[m].textContent = data[m];
    });
    setDecision(data.decision || 'keep');
    updateOverall();
  }

  function updateOverall(){
    const d = store[currentRegion];
    const sumW = Object.values(WEIGHTS).reduce((a,b)=>a+b,0);
    const overall = Math.round(
      (d.air*WEIGHTS.air + d.bio*WEIGHTS.bio + d.tour*WEIGHTS.tour + d.biz*WEIGHTS.biz) / sumW
    );
    overallScoreEl.textContent = overall;
    overallTagEl.textContent = overall>=85 ? 'excellent' : overall>=70 ? 'good' : overall>=50 ? 'Improve' : 'Needs Work';
  }

  function saveStore(){
    try{ localStorage.setItem('nature_scores_v1', JSON.stringify(store)); }catch(e){}
  }
  function loadStore(){
    try{
      const raw = localStorage.getItem('nature_scores_v1');
      return raw ? JSON.parse(raw) : null;
    }catch(e){ return null; }
  }
</script>

</body>
</html>
